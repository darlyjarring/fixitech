<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fixitech Studio Pro</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        :root { --primary: #00d4ff; --panel-bg: #252526; }
        body { margin: 0; font-family: 'Segoe UI', sans-serif; display: flex; height: 100vh; background: #121212; color: white; overflow: hidden; }

        /* PALETA IZQUIERDA */
        #palette {
            width: 320px; background: var(--panel-bg); padding: 20px; border-right: 1px solid #333;
            display: flex; flex-direction: column; gap: 15px; overflow-y: auto; z-index: 100;
        }

        h2 { font-size: 16px; color: var(--primary); margin: 0 0 10px 0; border-bottom: 1px solid #444; padding-bottom: 5px; }
        .control-group { display: flex; flex-direction: column; gap: 5px; margin-bottom: 10px; }
        label { font-size: 11px; color: #aaa; text-transform: uppercase; }
        
        input, select, button {
            background: #333; border: 1px solid #555; color: white; padding: 8px; border-radius: 4px; outline: none;
        }

        button { cursor: pointer; font-weight: bold; transition: 0.2s; }
        button:hover { background: #444; border-color: var(--primary); }
        .btn-main { background: #25d366; color: black; border: none; padding: 12px; margin-top: 10px; }

        /* AREA DE DISE√ëO */
        #workspace { flex-grow: 1; display: flex; justify-content: center; align-items: center; position: relative; }

        /* LIENZO DE WHATSAPP (9:16) */
        #canvas {
            width: 360px; height: 640px; background: black; position: relative;
            background-size: cover; background-position: center; overflow: hidden;
            box-shadow: 0 0 30px rgba(0,0,0,0.7);
        }

        /* ELEMENTOS MOVILES */
        .draggable {
            position: absolute; cursor: move; user-select: none; padding: 5px;
            display: inline-block; white-space: pre-wrap;
        }
        .draggable:hover { outline: 1px dashed var(--primary); }
        .draggable:active { outline: 2px solid var(--primary); }

        img.draggable { max-width: 150px; height: auto; }

        /* FUENTES */
        .f-sans { font-family: sans-serif; }
        .f-serif { font-family: serif; }
        .f-mono { font-family: monospace; }
        .f-impact { font-family: Impact, sans-serif; }
    </style>
</head>
<body>

    <aside id="palette">
        <h2>ESTUDIO FIXITECH</h2>
        
        <div class="control-group">
            <label>1. Fondo (Imagen URL)</label>
            <input type="text" id="bgInput" placeholder="URL de la imagen..." onchange="setBg(this.value)">
        </div>

        <div class="control-group">
            <label>2. A√±adir Imagen / Logo</label>
            <input type="file" accept="image/*" onchange="addImage(event)">
        </div>

        <div class="control-group">
            <label>3. Edici√≥n de Texto Seleccionado</label>
            <label>Color:</label>
            <input type="color" id="textColor" oninput="updateStyle('color', this.value)">
            <label>Tama√±o (px):</label>
            <input type="number" id="textSize" value="20" oninput="updateStyle('fontSize', this.value + 'px')">
            <label>Fuente:</label>
            <select id="textFont" onchange="updateStyle('fontFamily', this.value)">
                <option value="sans-serif">Normal (Arial)</option>
                <option value="Impact">Impact (Fuerte)</option>
                <option value="serif">Elegante</option>
                <option value="monospace">T√©cnica</option>
            </select>
        </div>

        <div class="control-group">
            <label>4. Acciones</label>
            <button onclick="addText()">+ A√±adir Nuevo Texto</button>
            <button onclick="deleteElement()" style="color: #ff5555;">Eliminar Seleccionado</button>
        </div>

        <button class="btn-main" onclick="saveDesign()">üì• DESCARGAR PARA WHATSAPP</button>
        <p style="font-size: 10px; color: #777;">Tip: Arrastra los elementos con el mouse para posicionarlos.</p>
    </aside>

    <main id="workspace">
        <div id="canvas" style="background-image: url('https://images.unsplash.com/photo-1517077304055-6e89abbf09b0?q=80&w=2069&auto=format&fit=crop');">
            <div class="draggable f-impact" style="top:50px; left:100px; font-size: 30px; color: #00d4ff;" onmousedown="selectEl(this)">FIXITECH</div>
            <div class="draggable" style="top:120px; left:40px; font-size: 22px; color: white; border-bottom: 2px solid #00d4ff;" onmousedown="selectEl(this)">SERVICIO T√âCNICO</div>
            <div class="draggable" style="top:200px; left:40px; font-size: 16px; color: white;" onmousedown="selectEl(this)">
‚Ä¢ CAMBIO DE PANTALLAS
‚Ä¢ CAMBIO DE BATER√çAS
‚Ä¢ REPARACI√ìN DE PLACA
‚Ä¢ CUENTAS GOOGLE
‚Ä¢ RESETEOS
            </div>
            <div class="draggable" style="top:580px; left:40px; font-size: 14px; color: #ccc;" onmousedown="selectEl(this)">inf. 0961187862 - Ing. Jos√© Jarr√≠n</div>
        </div>
    </main>

    <script>
        let selectedElement = null;

        // Selecci√≥n de elementos
        function selectEl(el) {
            selectedElement = el;
            // Cargar valores actuales en la paleta
            document.getElementById('textSize').value = parseInt(window.getComputedStyle(el).fontSize);
            if (el.tagName !== 'IMG') el.contentEditable = true;
        }

        // Actualizar estilo
        function updateStyle(prop, val) {
            if (selectedElement) {
                selectedElement.style[prop] = val;
            }
        }

        // A√±adir Texto
        function addText() {
            const div = document.createElement('div');
            div.className = 'draggable';
            div.innerText = 'Nuevo Texto (Click para editar)';
            div.style.top = '50%';
            div.style.left = '50%';
            div.style.fontSize = '20px';
            div.style.color = 'white';
            div.onmousedown = function() { selectEl(this); };
            document.getElementById('canvas').appendChild(div);
            makeDraggable(div);
        }

        // A√±adir Imagen
        function addImage(event) {
            const reader = new FileReader();
            reader.onload = function() {
                const img = document.createElement('img');
                img.src = reader.result;
                img.className = 'draggable';
                img.style.top = '10px';
                img.style.left = '10px';
                img.onmousedown = function() { selectEl(this); };
                document.getElementById('canvas').appendChild(img);
                makeDraggable(img);
            };
            reader.readAsDataURL(event.target.files[0]);
        }

        // Eliminar
        function deleteElement() {
            if (selectedElement) {
                selectedElement.remove();
                selectedElement = null;
            }
        }

        // Fondo
        function setBg(url) {
            document.getElementById('canvas').style.backgroundImage = `url('${url}')`;
        }

        // L√≥gica de Arrastre (Drag and Drop)
        function makeDraggable(el) {
            let pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;
            el.onmousedown = dragMouseDown;

            function dragMouseDown(e) {
                e.preventDefault();
                selectEl(el);
                pos3 = e.clientX;
                pos4 = e.clientY;
                document.onmouseup = closeDragElement;
                document.onmousemove = elementDrag;
            }

            function elementDrag(e) {
                e.preventDefault();
                pos1 = pos3 - e.clientX;
                pos2 = pos4 - e.clientY;
                pos3 = e.clientX;
                pos4 = e.clientY;
                el.style.top = (el.offsetTop - pos2) + "px";
                el.style.left = (el.offsetLeft - pos1) + "px";
            }

            function closeDragElement() {
                document.onmouseup = null;
                document.onmousemove = null;
            }
        }

        // Aplicar arrastre a elementos iniciales
        document.querySelectorAll('.draggable').forEach(makeDraggable);

        // Guardar Imagen
        function saveDesign() {
            // Deseleccionar para que no salga el borde en la foto
            const canvas = document.getElementById('canvas');
            html2canvas(canvas, { useCORS: true, scale: 2 }).then(canvasImg => {
                const link = document.createElement('a');
                link.download = 'Estado_Fixitech_Custom.png';
                link.href = canvasImg.toDataURL("image/png");
                link.click();
            });
        }
    </script>
</body>
</html>
